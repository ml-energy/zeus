# Generic single-database configuration using Alembic

For more about alembic refer to: <https://alembic.sqlalchemy.org/en/latest/tutorial.html>

Files under `/migrations` and `alembic.ini` are auto-generated by alembic by running a `alembic init migrations`. However, we need to modify `env.py` to connect the DB schema we defined in `models.py` and set up the db url.

`env.py`: this script will be invoked when the alembic is running the migration. Database url and db schema are set in this script. DB schema is set through `target_metadata = Base.metadata` and DB url is set by setting `"sqlalchemy.url"`

## Dependencies

```Bash
pip install '.[migration]'
```

## Generates alembic migration scripts

This will create scripts under ./versions

```Bash
alembic revision --autogenerate -m "Baseline: create tables" # will autogenerate tables
```

More about `--autogenerate` option: [Alembic Documentation](https://alembic.sqlalchemy.org/en/latest/autogenerate.html)

## Apply migration

```Bash
alembic upgrade head 
```
